{% extends "base.html" %}
{% load static %}
{% block title %}Study Materials{% endblock %}

{% block content %}
<div class="bg-[#0f172a] text-white min-h-screen relative overflow-hidden">
  <!-- Animated background elements -->
  <div class="fixed inset-0 overflow-hidden opacity-20 z-0 pointer-events-none">
    <div class="absolute top-0 left-1/4 w-72 h-72 bg-indigo-900 rounded-full mix-blend-screen filter blur-3xl opacity-20 animate-float1"></div>
    <div class="absolute top-1/3 right-1/4 w-64 h-64 bg-purple-900 rounded-full mix-blend-screen filter blur-3xl opacity-20 animate-float2"></div>
    <div class="absolute bottom-0 left-1/2 w-80 h-80 bg-sky-900 rounded-full mix-blend-screen filter blur-3xl opacity-20 animate-float3"></div>
  </div>

  <div class="relative z-10">
    
    <!-- Add Button in Top Right Corner -->
    <div class="absolute top-10 right-0 z-20 mr-8">
      <div class="relative">
        <button id="addNoteBtn" class="bg-gradient-to-r from-cyan-500 to-purple-500 text-white px-4 py-2 rounded-xl shadow-lg hover:shadow-2xl transform hover:scale-105 transition-all duration-300 font-semibold">
          Add
        </button>
        <div class="absolute right-3 top-2.5 text-cyan-400/70">
          
        </div>
      </div>
    </div>
    


    <!-- Header Section -->
    <div class="flex flex-col items-center px-6 py-8 text-center">
      <h1 class="text-4xl font-bold bg-clip-text text-transparent bg-gradient-to-r from-blue-400 to-cyan-300 mb-2">
        Study Materials
      </h1>
      <p class="text-lg text-gray-300 max-w-2xl">
        Browse all available course materials organized by semester
      </p>
    </div>

    <!-- Messages -->
    {% if messages %}
    <div class="mb-6">
      {% for message in messages %}
      <div class="p-4 mb-4 rounded-lg {% if message.tags == 'error' %}bg-red-500/20 border border-red-500/50{% else %}bg-green-500/20 border border-green-500/50{% endif %}">
        {{ message }}
      </div>
      {% endfor %}
    </div>
    {% endif %}

    <!-- 3D Notes Grid -->
    <div class="p-6 grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-8">
      
      {% for semester in semesters %}
      
      <!-- Clickable Card -->
      <a href="{% url 'semester_notes' semester.id %}" class="group block h-[220px] perspective-1000 hover:z-10 transition-all duration-500">
        <div class="relative h-full w-full preserve-3d group-hover:rotate-x-12 group-hover:rotate-y-2 group-hover:-translate-y-3 transition-transform duration-700">
          <div class="absolute inset-0 bg-gradient-to-br from-cyan-900/80 to-cyan-700/80 border-2 border-cyan-400/40 rounded-xl p-6 shadow-2xl backdrop-blur-sm transform-style-preserve-3d flex flex-col">
            <div class="flex items-center mb-4">
              <div class="w-4 h-4 rounded-full bg-cyan-400 mr-3 animate-pulse"></div>
              <h2 class="text-2xl font-bold text-cyan-200">Semester {{semester.name}}</h2>
            </div>
            <div class="bg-white/10 rounded-lg p-4 mb-4 border-l-4 border-cyan-400 flex-grow flex flex-col justify-center">
              <p class="text-xs text-cyan-200/80 uppercase tracking-wider mb-1">Available Materials</p>
              <p class="text-3xl font-bold text-white animate-bounce duration-1000">{{semester.notes.count}}</p>
            </div>
            <div class="flex justify-between items-center text-sm text-cyan-300/90">
              <span class="flex items-center">
                <svg class="w-4 h-4 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"></path>
                </svg>
                Notes
              </span>
              <span class="flex items-center">
                <svg class="w-4 h-4 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path>
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"></path>
                </svg>
                View
              </span>
            </div>
            <div class="absolute inset-y-0 left-0 w-2 bg-gradient-to-b from-cyan-400 to-cyan-600 rounded-l-xl"></div>
          </div>
          <div class="absolute inset-0 bg-cyan-500/30 blur-lg rounded-xl -z-10 translate-z-[-12px] group-hover:translate-z-[-20px] group-hover:opacity-80 transition-all duration-700"></div>
          <div class="absolute -top-2 -right-2 w-4 h-4 bg-white/30 rounded-full animate-float-particle1"></div>
          <div class="absolute top-1/4 -left-2 w-3 h-3 bg-white/20 rounded-full animate-float-particle2"></div>
          <div class="absolute bottom-4 -right-3 w-2 h-2 bg-white/10 rounded-full animate-float-particle3"></div>
        </div>
      </a>

      {% endfor %}
    </div>
  </div>
</div>

<style>
  /* Floating animation for background elements */
  @keyframes float1 {
    0%, 100% { transform: translateY(0) translateX(0); }
    50% { transform: translateY(-15px) translateX(10px); }
  }
  @keyframes float2 {
    0%, 100% { transform: translateY(0) translateX(0); }
    50% { transform: translateY(10px) translateX(-15px); }
  }
  @keyframes float3 {
    0%, 100% { transform: translateY(0) translateX(0); }
    50% { transform: translateY(-10px) translateX(5px); }
  }
  .animate-float1 { animation: float1 10s ease-in-out infinite; }
  .animate-float2 { animation: float2 12s ease-in-out infinite; }
  .animate-float3 { animation: float3 14s ease-in-out infinite; }

  /* Particle animations */
  @keyframes float-particle1 {
    0%, 100% { transform: translateY(0) translateX(0); }
    50% { transform: translateY(-5px) translateX(3px); }
  }
  @keyframes float-particle2 {
    0%, 100% { transform: translateY(0) translateX(0); }
    50% { transform: translateY(4px) translateX(-2px); }
  }
  @keyframes float-particle3 {
    0%, 100% { transform: translateY(0) translateX(0); }
    50% { transform: translateY(-3px) translateX(1px); }
  }
  .animate-float-particle1 { animation: float-particle1 4s ease-in-out infinite; }
  .animate-float-particle2 { animation: float-particle2 5s ease-in-out infinite 1s; }
  .animate-float-particle3 { animation: float-particle3 6s ease-in-out infinite 0.5s; }

  /* Bounce animation for numbers */
  @keyframes bounce {
    0%, 100% { transform: translateY(0); }
    50% { transform: translateY(-8px); }
  }
  .animate-bounce { animation: bounce 1.5s infinite; }

  /* 3D Effects */
  .perspective-1000 {
    perspective: 1000px;
  }
  .preserve-3d {
    transform-style: preserve-3d;
  }
  .transform-style-preserve-3d {
    transform-style: preserve-3d;
  }
  .group-hover\:rotate-x-12:hover {
    transform: rotateX(12deg) rotateY(2deg);
  }
  .translate-z-\[-12px\] {
    transform: translateZ(-12px);
  }
  .group-hover\:translate-z-\[-20px\]:hover {
    transform: translateZ(-20px);
  }
</style>






  <!-- Modal Background -->
<div id="noteModal" class="fixed inset-0 bg-black/50 flex items-center justify-center z-50 hidden">
  <!-- Modal Box -->
  <div class="bg-white/10 backdrop-blur-md p-6 rounded-2xl border border-white/20 w-full max-w-md shadow-xl text-white">
    <h2 class="text-xl font-bold mb-4">Add Note</h2>
    <form method="POST" enctype="multipart/form-data" action="{% url 'add_note' %}">
      {% csrf_token %}
      
      <div class="mb-4">
        <label class="block text-sm font-semibold mb-1">Note Name</label>
        <input type="text" name="name" required class="w-full px-3 py-2 rounded-lg bg-white/10 border border-purple-400/60 focus:outline-none focus:ring-2 focus:ring-purple-400">
      </div>

      <div class="mb-4">
        <label class="block text-sm font-semibold mb-1">Description</label>
        <input type="text" name="description" maxlength="150" required class="w-full px-3 py-2 rounded-lg bg-white/10 border border-purple-400/60">
      </div>

      <div class="mb-4">
        <label class="block text-sm font-semibold mb-1">Page Number</label>
        <input type="number" name="page_no" required class="w-full px-3 py-2 rounded-lg bg-white/10 border border-purple-400/60">
      </div>

      <div class="mb-4">
        <label class="block text-sm font-semibold mb-1">Semester</label>
        <select name="semester" class="w-full bg-transparent border border-purple-400/60 text-white rounded-lg px-4 py-2.5 focus:outline-none focus:ring-2 focus:ring-purple-400 shadow-inner shadow-purple-300/20">
          <option value="" {% if user.userprofile.semester == '' %}selected{% endif %}>Not Selected</option>
          <option value="1.1" {% if user.userprofile.semester == '1.1' %}selected{% endif %}>Semester 1.1</option>
          <option value="1.2" {% if user.userprofile.semester == '1.2' %}selected{% endif %}>Semester 1.2</option>
          <option value="2.1" {% if user.userprofile.semester == '2.1' %}selected{% endif %}>Semester 2.1</option>
          <option value="2.2" {% if user.userprofile.semester == '2.2' %}selected{% endif %}>Semester 2.2</option>
          <option value="3.1" {% if user.userprofile.semester == '3.1' %}selected{% endif %}>Semester 3.1</option>
          <option value="3.2" {% if user.userprofile.semester == '3.2' %}selected{% endif %}>Semester 3.2</option>
          <option value="4.1" {% if user.userprofile.semester == '4.1' %}selected{% endif %}>Semester 4.1</option>
          <option value="4.2" {% if user.userprofile.semester == '4.2' %}selected{% endif %}>Semester 4.2</option>
        
      </select>
      </div>

      <div class="mb-4">
        <label class="block text-sm font-semibold mb-1">File</label>
        <input type="file" name="file" required class="w-full px-3 py-2 text-white">
      </div>

      <input type="hidden" name="semester_id" value="{{ semester.id }}">  <!-- Or handle via form logic -->

      <div class="flex justify-end gap-2">
        <button type="button" id="closeModalBtn" class="px-4 py-2 bg-red-500/70 rounded-lg hover:bg-red-600">Cancel</button>
        <button type="submit" class="px-4 py-2 bg-green-500/70 rounded-lg hover:bg-green-600">Save</button>
      </div>
    </form>
  </div>
</div>



<script>
  const modal = document.getElementById('noteModal');
  const openBtn = document.getElementById('addNoteBtn');
  const closeBtn = document.getElementById('closeModalBtn');

  openBtn.addEventListener('click', () => modal.classList.remove('hidden'));
  closeBtn.addEventListener('click', () => modal.classList.add('hidden'));
</script>







{% endblock %}
